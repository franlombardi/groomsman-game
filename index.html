<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Misi√≥n Lisboa 2026</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    :root {
      --bg-page: #3f5e42;
      --card-bg: #ffffff;
      --card-border: #e2d7c9;
      --text-main: #2f3b32;
      --text-muted: #7b8577;
      --accent: #3f5e42;
      --accent-soft: #6f8b73;
      --danger: #c0564a;
      --good: #3f5e42;
      --radius-xl: 20px;
      --radius-lg: 10px;
      --shadow-soft: 0 14px 30px rgba(15, 23, 42, 0.08);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }

    body {
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: var(--bg-page);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .app {
      width: 100%;
      max-width: 430px;
      background: var(--card-bg);
      border-radius: 24px;
      border: 1px solid var(--card-border);
      box-shadow: var(--shadow-soft);
      padding: 18px 18px 20px;
      position: relative;
      overflow: hidden;
    }

    .app::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at top left, rgba(255, 255, 255, 0.65), transparent 55%),
        radial-gradient(circle at bottom right, rgba(222, 209, 193, 0.7), transparent 60%);
      pointer-events: none;
      z-index: -1;
    }

    header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .title-block { display: flex; flex-direction: column; gap: 4px; }
    .subtitle { font-size: 0.68rem; letter-spacing: 0.16em; text-transform: uppercase; color: var(--accent-soft); }
    h1 { font-family: Georgia, "Times New Roman", serif; font-size: 1.3rem; letter-spacing: 0.04em; font-weight: 600; }

    .badge {
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(242, 237, 229, 0.9);
      border: 1px solid var(--card-border);
      font-size: 0.7rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--text-muted);
    }
    .badge .icon { font-size: 1rem; }

    .hud { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.7rem; color: var(--text-muted); }
    .hud-pill {
      padding: 3px 10px;
      border-radius: 999px;
      background: #f4ece3;
      border: 1px solid var(--card-border);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }
    .hud-pill .value { font-weight: 600; color: var(--accent-soft); }
    .hud-pill.good .value { color: var(--good); }

    .hint { font-size: 0.7rem; color: var(--text-muted); margin-bottom: 10px; }

    .card {
      border-radius: var(--radius-xl);
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      padding: 16px 16px 14px;
      min-height: 260px;
      display: none;
      flex-direction: column;
      justify-content: space-between;
    }
    .card.active { display: flex; }

    .card-header-tag { font-size: 0.68rem; letter-spacing: 0.16em; text-transform: uppercase; color: var(--accent-soft); margin-bottom: 6px; }
    .card-title { font-size: 1.05rem; font-weight: 600; margin-bottom: 6px; }
    .card-body { font-size: 0.8rem; color: var(--text-muted); line-height: 1.5; }
    .card-body strong { color: var(--accent-soft); font-weight: 600; }

    .options { margin-top: 14px; display: flex; flex-direction: column; gap: 8px; }

    .option-btn {
      width: 100%;
      padding: 11px 12px;
      border-radius: 8px;
      border: 1px solid var(--card-border);
      background: #f6f0e8;
      color: var(--text-main);
      font-size: 0.8rem;
      text-align: left;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      cursor: pointer;
      box-shadow: 0 6px 12px rgba(15, 23, 42, 0.05);
      transition: transform 0.06s ease, box-shadow 0.06s ease, border-color 0.06s ease, background 0.06s ease;
    }
    .option-btn .label { flex: 1; }
    .option-btn .key { font-size: 0.7rem; color: var(--text-muted); }
    .option-btn:active { transform: translateY(1px); box-shadow: 0 4px 8px rgba(15, 23, 42, 0.08); border-color: var(--accent-soft); }
    .option-btn.correct { border-color: var(--good); background: #e4f0e6; box-shadow: 0 6px 14px rgba(63, 94, 66, 0.12); }
    .option-btn.wrong { border-color: var(--danger); background: #fce9e7; opacity: 0.98; }

    .btn-row { margin-top: 16px; display: flex; flex-direction: column; gap: 8px; }

    .btn {
      border: none;
      border-radius: 6px;
      padding: 11px 10px;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 8px 16px rgba(63, 94, 66, 0.25);
      transition: transform 0.06s ease, box-shadow 0.06s ease, background 0.06s ease;
    }
    .btn-primary { background: var(--accent); color: #f7f4ee; }
    .btn-primary:active { transform: translateY(1px); box-shadow: 0 4px 10px rgba(63, 94, 66, 0.35); }
    .btn-secondary { background: transparent; color: var(--accent); border: 1px solid var(--accent); box-shadow: none; }
    .btn-secondary:active { transform: translateY(1px); box-shadow: 0 3px 8px rgba(63, 94, 66, 0.25); }
    .btn .icon { font-size: 1rem; }

    .small-text { margin-top: 6px; font-size: 0.68rem; color: var(--text-muted); }
    .small-text strong { color: var(--accent-soft); }

    .score-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 8px;
      border-radius: 999px;
      background: #f4ece3;
      border: 1px solid var(--card-border);
      font-size: 0.68rem;
      color: var(--text-muted);
    }
    .score-pill .value { color: var(--good); font-weight: 600; }

    footer { margin-top: 8px; text-align: center; font-size: 0.64rem; color: var(--text-muted); }
    footer strong { color: var(--accent-soft); }

    .final-photo {
      width: 100%;
      max-width: 280px;
      margin: 16px auto 0;
      border-radius: 12px;
      display: block;
      box-shadow: 0 8px 20px rgba(15, 23, 42, 0.12);
    }

    @media (max-width: 380px) {
      .app { border-radius: 20px; padding: 14px; }
      .card { border-radius: 16px; padding: 14px; }
    }

    #confettiCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 9999; }
  </style>
</head>
<body>
  <canvas id="confettiCanvas"></canvas>
  <div class="app">
    <header>
      <div class="title-block">
        <span class="subtitle">Cuestionario de boda</span>
        <h1>Lisboa: Sep 20, 2026</h1>
      </div>
      <div class="badge">
        <span class="icon">üáµüáπ</span>
        <span id="roleLabel">Verificaci√≥n</span>
      </div>
    </header>

    <div id="hud" class="hud">
      <div class="hud-pill"><span>Question</span><span class="value" id="hudQuestion">0 / 0</span></div>
      <div class="hud-pill good"><span>Score</span><span class="value" id="hudScore">0</span></div>
    </div>

    <div id="hint" class="hint">Responde honestamente. Sin ayuda.</div>

    <div id="cardIntro" class="card active">
      <div>
        <div class="card-header-tag">Verificaci√≥n</div>
        <div class="card-title" id="introTitle"></div>
        <div class="card-body" id="introBody"></div>
      </div>
      <div>
        <div class="btn-row">
          <button id="btnStart" class="btn btn-primary"><span class="icon">‚ñ∂Ô∏è</span><span>Comenzar</span></button>
        </div>
        <div class="small-text">Hazle screenshot al resultado cuando termines.</div>
      </div>
    </div>

    <div id="cardQuestion" class="card">
      <div>
        <div class="card-header-tag" id="questionTag"></div>
        <div class="card-title" id="questionTitle"></div>
        <div class="card-body" id="questionBody"></div>
        <div class="options" id="optionsContainer"></div>
      </div>
      <div class="small-text" id="questionHint"></div>
    </div>

    <div id="cardResult" class="card">
      <div>
        <div class="card-header-tag">Resultados</div>
        <div class="card-title" id="resultTitle"></div>
        <div class="card-body" id="resultBody"></div>
      </div>
      <div>
        <div class="btn-row">
          <button id="btnYes1" class="btn btn-primary"></button>
          <button id="btnYes2" class="btn btn-secondary"></button>
        </div>
        <div class="small-text">
          <span class="score-pill"><span>Test score</span><span class="value" id="resultScoreText">0 / 0</span></span>
        </div>
      </div>
    </div>

    <div id="cardFinal" class="card">
      <div>
        <div class="card-header-tag">Squad locked</div>
        <div class="card-title" id="finalTitle"></div>
        <div class="card-body" id="finalBody"></div>
      </div>
      <div>
        <div class="btn-row">
          <button id="btnDone" class="btn btn-primary"><span class="icon">üì≤</span><span>Listo</span></button>
        </div>
        <div class="small-text">Puedes cerrar esta pesta√±a. LET'S GO!</div>
      </div>
    </div>

    <footer>Lisboa <strong>09.20.2026</strong></footer>
  </div>

<script>
(function() {
  'use strict';

  // ===================== CONFIGURATION =====================
  const CONFIG = {
    transitionDelay: 3000,
    answerFeedbackDelay: 1400,
    confettiCount: 80,
    colors: ['#3f5e42', '#6f8b73', '#e2d7c9', '#f2ede5', '#c0564a', '#7b8577']
  };

  const QUESTIONS = {
    wedding: [
      { title: "¬øD√≥nde fue mi primera cita con Ana?", options: ["Mini Golf, Budare Bistro y Cine", "Casino, ELEVEN y Panna Express", "Weston Town Center y Yogurtland"], correctIndex: 0 },
      { title: "¬øCu√°ndo y c√≥mo le ped√≠ a Ana que fuera mi novia?", options: ["9 de Julio de 2017 afuera de su casa con un Teddy Bear despu√©s de regresar de un catamaran", "14 de Febrero del 2018 en Waffle House despu√©s de regresar de una rumba en Space", "7 de Septiembre de 2017 en las Bahamas mientras disfrut√°bamos de un Mojito"], correctIndex: 0 },
      { title: "¬øCu√°ndo le propuse matrimonio a Ana?", options: ["6 de Agosto, 2023", "12 de Septiembre, 2023", "7 de Agosto, 2023"], correctIndex: 0 },
      { title: "¬øD√≥nde le propuse matrimonio a Ana?", options: ["En NYC", "En Chacaito", "En San Francisco"], correctIndex: 0 }
    ],
    personal: [
      { title: "¬øSoy fiel fan de cu√°l equipo de f√∫tbol?", options: ["AC Milan", "Real Madrid", "Deportivo Tachira"], correctIndex: 0 },
      { title: "¬øCu√°l es mi comida favorita?", options: ["Pasta con salsa roja", "Caraotas con mayonesa", "Sushi"], correctIndex: 0 },
      { title: "Si vamos a un bar, ¬øqu√© NO me vas a ver tomando?", options: ["Cerveza", "Aperol Spritz", "Anis"], correctIndex: 0 }
    ],
    howWeMet: {
      diego: { title: "¬øC√≥mo nos conocimos?<br>(tu y yo... cero maricoteo)", options: ["En clase de algebra del panita Kline", "En un dayger", "En una lanchita en los Roques"], correctIndex: 0 },
      marco: { title: "¬øC√≥mo nos conocimos?<br>(tu y yo... cero maricoteo)", options: ["Haciendo la fila para buscar los libros antes de empezar Sophomore year de high school", "En una competencia de natacion en el club italo", "En un open party en Savanna"], correctIndex: 0 },
      gabriel: { title: "¬øC√≥mo nos conocimos?<br>(tu y yo... cero maricoteo)", options: ["En Dave & Buster's", "En el carrito de perro caliente al frente del Tolon", "En un burdel comiendo carne molia"], correctIndex: 0 },
      guillermo: { title: "¬øC√≥mo nos conocimos?<br>(tu y yo... cero maricoteo)", options: ["En high school en una clase de Slutsky", "En la heladeria coldstone", "En un dayger random"], correctIndex: 0 },
      daniel: { title: "¬øC√≥mo nos conocimos?<br>(tu y yo... cero maricoteo)", options: ["Un dia random en Cypress durante lunch", "En los tryouts de Weston FC academy", "En un burdel por la calle 8"], correctIndex: 0 },
      andres: { title: "¬øC√≥mo nos conocimos?<br>(tu y yo... cero maricoteo)", options: ["En tu casa un dia random", "En una lanchita en los Roques", "En un burdel por la calle 8"], correctIndex: 0 }
    }
  };

  const PEOPLE = {
    diego: { fullName: "Diego Sabal", nickname: "Dieguish", role: "Best Man", finalImage: "images/Diego.jpeg" },
    marco: { fullName: "Marco Guarente", nickname: "MarCookie", role: "Best Man", finalImage: "images/Marco.jpeg" },
    gabriel: { fullName: "Gabriel Sosa", nickname: "Gabiri", role: "Groomsman", finalImage: "images/Gabriel.jpeg" },
    guillermo: { fullName: "Guillermo Stalhuth", nickname: "Guillo", role: "Groomsman", finalImage: "images/Guillermo.jpeg" },
    andres: { fullName: "Andres Sabal", nickname: "Andres", role: "Groomsman", finalImage: "images/Andres.jpeg" },
    daniel: { fullName: "Daniel Najul", nickname: "Najulzin", role: "Groomsman", finalImage: "images/Daniel.jpeg" }
  };

  const RESULT_TIERS = [
    { minScore: (total) => total - 1, title: 'Fenomeno', getMessage: (name, score, total) => `${name}, lo hiciste increible con ${score}/${total}.` },
    { minScore: (total) => Math.floor(total / 2), title: 'Pasaste‚Ä¶ de vaina', getMessage: (name, score, total) => `${name}, ${score}/${total}.<br>S√≥lido, un poco sospechoso, pero aceptado.` },
    { minScore: () => 0, title: 'Uhmm raspaste‚Ä¶', getMessage: (name, score, total) => `${name}, solo ${score}/${total}.<br>A√∫n as√≠ elegido estas salvado.` }
  ];

  const ROLE_CONFIG = {
    'Best Man': { icon: 'üëë', buttonText: 'Ser tu Best Man' },
    'Groomsman': { icon: 'ü§ù', buttonText: 'Ser tu Groomsman' }
  };

  // ===================== UTILITIES =====================
  const $ = (id) => document.getElementById(id);
  const getQueryParam = (key) => new URLSearchParams(window.location.search).get(key);

  const shuffleArray = (arr) => {
    const shuffled = [...arr];
    for (let i = shuffled.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
    }
    return shuffled;
  };

  const shuffleQuestionOptions = (q) => {
    const correctAnswer = q.options[q.correctIndex];
    const shuffledOptions = shuffleArray(q.options);
    return { ...q, options: shuffledOptions, correctIndex: shuffledOptions.indexOf(correctAnswer) };
  };

  const buildQuestionsForPerson = (personId) => {
    const allQuestions = [...QUESTIONS.wedding, QUESTIONS.howWeMet[personId], ...QUESTIONS.personal];
    return allQuestions.map(shuffleQuestionOptions);
  };

  const getResultTier = (score, total) => RESULT_TIERS.find(tier => score >= tier.minScore(total));

  // ===================== DOM ELEMENTS =====================
  const el = {
    roleLabel: $('roleLabel'),
    introTitle: $('introTitle'),
    introBody: $('introBody'),
    hud: $('hud'),
    hint: $('hint'),
    hudQuestion: $('hudQuestion'),
    hudScore: $('hudScore'),
    questionTag: $('questionTag'),
    questionTitle: $('questionTitle'),
    questionBody: $('questionBody'),
    optionsContainer: $('optionsContainer'),
    questionHint: $('questionHint'),
    resultTitle: $('resultTitle'),
    resultBody: $('resultBody'),
    resultScoreText: $('resultScoreText'),
    btnYes1: $('btnYes1'),
    btnYes2: $('btnYes2'),
    finalTitle: $('finalTitle'),
    finalBody: $('finalBody'),
    cardIntro: $('cardIntro'),
    cardQuestion: $('cardQuestion'),
    cardResult: $('cardResult'),
    cardFinal: $('cardFinal'),
    btnStart: $('btnStart'),
    btnDone: $('btnDone')
  };

  const allCards = [el.cardIntro, el.cardQuestion, el.cardResult, el.cardFinal];

  // ===================== STATE =====================
  const personId = getQueryParam('id');
  const person = PEOPLE[personId];
  const questions = person ? buildQuestionsForPerson(personId) : [];

  const state = { currentIndex: 0, score: 0, hasFinalized: false };

  // ===================== UI FUNCTIONS =====================
  const showCard = (card) => {
    allCards.forEach(c => c.classList.remove('active'));
    card.classList.add('active');
  };

  const updateHud = () => {
    el.hudQuestion.textContent = `${Math.min(state.currentIndex + 1, questions.length)} / ${questions.length}`;
    el.hudScore.textContent = state.score;
  };

  const renderQuestion = () => {
    const q = questions[state.currentIndex];
    el.questionTag.textContent = `Pregunta ${state.currentIndex + 1}`;
    el.questionTitle.innerHTML = q.title;
    el.questionBody.textContent = '';
    el.optionsContainer.innerHTML = '';

    q.options.forEach((opt, idx) => {
      const btn = document.createElement('button');
      btn.className = 'option-btn';
      btn.type = 'button';
      btn.innerHTML = `<span class="label">${opt}</span><span class="key">${idx + 1}</span>`;
      btn.onclick = () => handleAnswer(btn, idx);
      el.optionsContainer.appendChild(btn);
    });

    el.questionHint.textContent = state.currentIndex === questions.length - 1 ? '√öltima pregunta.' : 'Tienes un intento por pregunta.';
    updateHud();
  };

  const showTransition = () => {
    el.questionTag.textContent = 'Transici√≥n';
    el.questionTitle.textContent = 'Ahora, unas personales...';
    el.questionBody.textContent = '';
    el.optionsContainer.innerHTML = '';
    el.questionHint.textContent = '';
    setTimeout(renderQuestion, CONFIG.transitionDelay);
  };

  const showResult = () => {
    const total = questions.length;
    const tier = getResultTier(state.score, total);
    const roleConfig = ROLE_CONFIG[person.role];

    el.hud.style.display = 'none';
    el.hint.style.display = 'none';

    el.resultScoreText.textContent = `${state.score} / ${total}`;
    el.resultTitle.textContent = tier.title;

    const revealIntro = 'Quer√≠a confirmar que eras digno de nuestra amistad y apto para lo que realmente necesito pedirte...';
    el.resultBody.innerHTML = `${tier.getMessage(person.fullName, state.score, total)}<br><br>${revealIntro}<br><br>Bueno, el punto de todo esto:<br><strong style="font-size: 1.15em;">Quiero que seas mi ${person.role}.</strong><br><br>Tienes dos opciones:`;

    el.btnYes1.innerHTML = `<span class="icon">${roleConfig.icon}</span><span>${roleConfig.buttonText}</span>`;
    el.btnYes2.innerHTML = '<span class="icon">üî•</span><span>Acepto... No tengo opci√≥n.</span>';
    el.btnYes1.onclick = el.btnYes2.onclick = chooseFinalRole;

    showCard(el.cardResult);
  };

  const chooseFinalRole = () => {
    el.hud.style.display = 'none';
    el.hint.style.display = 'none';

    el.finalTitle.textContent = `Eres mi ${person.role}`;
    el.finalBody.innerHTML = `${person.fullName}, oficialmente eres mi ${person.role}.<br><br>Toma screenshot y m√°ndamelo!`;

    const existingImg = el.cardFinal.querySelector('.final-photo');
    if (existingImg) existingImg.remove();

    if (person.finalImage) {
      const img = document.createElement('img');
      img.className = 'final-photo';
      img.src = person.finalImage;
      img.alt = `${person.fullName}'s photo`;
      el.finalBody.appendChild(img);
    }

    showCard(el.cardFinal);
    setTimeout(launchConfetti, 200);
  };

  // ===================== EVENT HANDLERS =====================
  const handleAnswer = (buttonEl, selectedIdx) => {
    const q = questions[state.currentIndex];
    if (buttonEl.disabled) return;

    [...el.optionsContainer.children].forEach(b => b.disabled = true);

    const isCorrect = selectedIdx === q.correctIndex;
    buttonEl.classList.add(isCorrect ? 'correct' : 'wrong');

    if (isCorrect) {
      state.score++;
    } else {
      el.optionsContainer.children[q.correctIndex]?.classList.add('correct');
    }

    el.questionHint.textContent = `Respondiste: "${q.options[selectedIdx]}" ‚Äî Correcto: "${q.options[q.correctIndex]}"`;
    updateHud();

    setTimeout(() => {
      if (++state.currentIndex < questions.length) {
        state.currentIndex === 4 ? showTransition() : renderQuestion();
      } else {
        showResult();
      }
    }, CONFIG.answerFeedbackDelay);
  };

  const finalizeAndClose = () => {
    if (state.hasFinalized) return;
    state.hasFinalized = true;

    try { window.close(); } catch {}

    el.btnDone.disabled = true;
    el.btnDone.style.display = 'none';

    if (!el.finalBody.textContent.includes('Si la pesta√±a no se cierra')) {
      el.finalBody.innerHTML += ' Si la pesta√±a no se cierra, puedes cerrarla manualmente.';
    }
  };

  // ===================== CONFETTI =====================
  const launchConfetti = () => {
    const canvas = document.getElementById('confettiCanvas');
    if (!canvas) return;

    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    const confetti = Array.from({ length: CONFIG.confettiCount }, () => ({
      x: Math.random() * canvas.width,
      y: Math.random() * canvas.height - canvas.height,
      r: Math.random() * 4 + 2,
      d: Math.random() * CONFIG.confettiCount,
      color: CONFIG.colors[Math.floor(Math.random() * CONFIG.colors.length)],
      tilt: Math.floor(Math.random() * 10) - 10,
      tiltAngleIncrement: Math.random() * 0.07 + 0.05,
      tiltAngle: 0
    }));

    let angle = 0;

    const draw = () => {
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      confetti.forEach(c => {
        ctx.beginPath();
        ctx.lineWidth = c.r / 2;
        ctx.strokeStyle = c.color;
        ctx.moveTo(c.x + c.tilt + c.r / 4, c.y);
        ctx.lineTo(c.x + c.tilt, c.y + c.tilt + c.r / 4);
        ctx.stroke();

        c.tiltAngle += c.tiltAngleIncrement;
        c.y += (Math.cos(angle + c.d) + 3 + c.r / 2) / 2;
        c.x += Math.sin(angle);
        c.tilt = Math.sin(c.tiltAngle) * 15;
      });

      angle += 0.01;

      if (!confetti.every(c => c.y > canvas.height + 20)) {
        requestAnimationFrame(draw);
      } else {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      }
    };

    draw();
  };

  // ===================== INITIALIZATION =====================
  const init = () => {
    if (person) {
      el.roleLabel.textContent = 'Boda 2026';
      el.introTitle.textContent = `${person.nickname}, tengo que confirmar algo antes de la boda.`;
      el.introBody.innerHTML = `Responde estas preguntas.<br>(Toma menos de 2 minutos)<br><br>Gracias!`;
    } else {
      el.roleLabel.textContent = 'Enlace Inv√°lido';
      el.introTitle.textContent = '¬°Oops!';
      el.introBody.innerHTML = '<strong>Este enlace no est√° configurado.</strong><br><br>Escr√≠beme para pedir el link correcto.';
      el.btnStart.disabled = true;
      el.btnStart.textContent = 'Enlace Inv√°lido';
    }

    el.btnStart.onclick = () => {
      if (person && questions.length) {
        state.currentIndex = 0;
        state.score = 0;
        renderQuestion();
        showCard(el.cardQuestion);
      }
    };

    el.btnDone.onclick = finalizeAndClose;

    window.onresize = () => {
      const canvas = document.getElementById('confettiCanvas');
      if (canvas) {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
      }
    };

    updateHud();
  };

  init();
})();
</script>
</body>
</html>
