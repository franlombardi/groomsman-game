<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Best Man Qualification Test</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    :root {
      --bg-top: #050816;
      --bg-bottom: #141b3b;
      --card-bg: #0b1022;
      --card-border: rgba(148, 163, 184, 0.4);
      --text-main: #f9fafb;
      --text-muted: #9ca3af;
      --accent: #fbbf24;
      --accent-soft: #fde68a;
      --danger: #f97373;
      --good: #4ade80;
      --radius-xl: 24px;
      --radius-lg: 16px;
      --shadow-soft: 0 18px 40px rgba(0, 0, 0, 0.7);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      -webkit-tap-highlight-color: transparent;
    }

    body {
      min-height: 100vh;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "SF Pro Text",
        "Segoe UI", sans-serif;
      background: radial-gradient(circle at top, #111827 0, #020617 55%);
      color: var(--text-main);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
    }

    .app {
      width: 100%;
      max-width: 430px;
      background: linear-gradient(145deg, var(--bg-top), var(--bg-bottom));
      border-radius: 32px;
      border: 1px solid rgba(15, 23, 42, 0.9);
      box-shadow: var(--shadow-soft);
      padding: 16px 16px 18px;
      position: relative;
      overflow: hidden;
    }

    .app::before {
      content: "";
      position: absolute;
      inset: 0;
      background:
        radial-gradient(circle at top left, rgba(248, 250, 252, 0.07), transparent 60%),
        radial-gradient(circle at bottom right, rgba(15, 23, 42, 0.9), transparent 50%);
      pointer-events: none;
      z-index: -1;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .title-block {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .subtitle {
      font-size: 0.7rem;
      letter-spacing: 0.14em;
      text-transform: uppercase;
      color: var(--accent-soft);
    }

    h1 {
      font-size: 1.35rem;
      letter-spacing: 0.04em;
    }

    .badge {
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.5);
      font-size: 0.7rem;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      color: var(--text-muted);
    }

    .badge span.icon {
      font-size: 1rem;
    }

    .hud {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .hud-pill {
      padding: 3px 10px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.95);
      border: 1px solid rgba(148, 163, 184, 0.5);
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .hud-pill span.value {
      font-weight: 600;
      color: var(--accent-soft);
    }

    .hud-pill.good span.value {
      color: var(--good);
    }

    .hud-pill.bad span.value {
      color: var(--danger);
    }

    .hint {
      font-size: 0.68rem;
      color: var(--text-muted);
      margin-bottom: 10px;
    }

    .card {
      border-radius: var(--radius-xl);
      background: radial-gradient(circle at top, #020617 0, #020617 100%);
      border: 1px solid var(--card-border);
      padding: 16px 16px 14px;
      min-height: 280px;
      display: none;
      flex-direction: column;
      justify-content: space-between;
    }

    .card.active {
      display: flex;
    }

    .card-header-tag {
      font-size: 0.68rem;
      letter-spacing: 0.16em;
      text-transform: uppercase;
      color: var(--accent-soft);
      margin-bottom: 6px;
    }

    .card-title {
      font-size: 1.05rem;
      font-weight: 700;
      margin-bottom: 6px;
    }

    .card-body {
      font-size: 0.8rem;
      color: var(--text-muted);
      line-height: 1.4;
    }

    .card-body strong {
      color: var(--accent-soft);
      font-weight: 600;
    }

    .options {
      margin-top: 14px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .option-btn {
      width: 100%;
      padding: 10px 10px;
      border-radius: var(--radius-lg);
      border: 1px solid rgba(148, 163, 184, 0.6);
      background: linear-gradient(135deg, #020617, #111827);
      color: var(--text-main);
      font-size: 0.8rem;
      text-align: left;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 10px;
      cursor: pointer;
      box-shadow: 0 10px 24px rgba(15, 23, 42, 0.7);
      transition:
        transform 0.08s ease,
        box-shadow 0.08s ease,
        border-color 0.08s ease,
        background 0.08s ease;
    }

    .option-btn span.label {
      flex: 1;
    }

    .option-btn span.key {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    .option-btn:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 6px 18px rgba(15, 23, 42, 0.9);
      border-color: var(--accent-soft);
    }

    .btn-row {
      margin-top: 16px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .btn {
      border: none;
      border-radius: var(--radius-lg);
      padding: 11px 10px;
      font-size: 0.8rem;
      font-weight: 600;
      letter-spacing: 0.06em;
      text-transform: uppercase;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      box-shadow: 0 12px 30px rgba(15, 23, 42, 0.8);
      transition: transform 0.08s ease, box-shadow 0.08s ease, background 0.08s ease;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-soft));
      color: #111827;
    }

    .btn-primary:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 7px 18px rgba(250, 204, 21, 0.5);
    }

    .btn-secondary {
      background: linear-gradient(135deg, #020617, #111827);
      color: var(--text-main);
      border: 1px solid rgba(148, 163, 184, 0.7);
    }

    .btn-secondary:active {
      transform: translateY(1px) scale(0.99);
      box-shadow: 0 7px 18px rgba(15, 23, 42, 0.9);
    }

    .btn span.icon {
      font-size: 1rem;
    }

    .small-text {
      margin-top: 6px;
      font-size: 0.68rem;
      color: var(--text-muted);
    }

    .small-text strong {
      color: var(--accent-soft);
    }

    .score-pill {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(148, 163, 184, 0.6);
      font-size: 0.68rem;
      color: var(--text-muted);
    }

    .score-pill span.value {
      color: var(--good);
      font-weight: 600;
    }

    footer {
      margin-top: 8px;
      text-align: center;
      font-size: 0.64rem;
      color: var(--text-muted);
    }

    footer strong {
      color: var(--accent-soft);
    }

    @media (max-width: 380px) {
      .app {
        border-radius: 24px;
        padding: 12px;
      }

      .card {
        border-radius: 18px;
        padding: 14px;
      }
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="title-block">
        <span class="subtitle">Mini mission</span>
        <h1>Best Man Qualification Test</h1>
      </div>
      <div class="badge">
        <span class="icon">ü§µ‚Äç‚ôÇÔ∏è</span>
        <span id="roleLabel">Wedding Squad</span>
      </div>
    </header>

    <div class="hud">
      <div class="hud-pill">
        <span>Question</span>
        <span class="value" id="hudQuestion">0 / 0</span>
      </div>
      <div class="hud-pill good">
        <span>Score</span>
        <span class="value" id="hudScore">0</span>
      </div>
    </div>

    <div class="hint">
      All you have to do is tap the option that feels most correct. No lifelines, only instinct.
    </div>

    <!-- Intro card -->
    <div id="cardIntro" class="card active">
      <div>
        <div class="card-header-tag">Briefing</div>
        <div class="card-title" id="introTitle">Welcome, my friend</div>
        <div class="card-body" id="introBody">
          This is your <strong>Best Man Qualification Test</strong>, also known as the Worst Man stress test.<br /><br />
          You will get a few quick questions about our chaos and my life choices. There is no official pass mark,
          but I will absolutely judge you silently.
        </div>
      </div>
      <div>
        <div class="btn-row">
          <button id="btnStart" class="btn btn-primary">
            <span class="icon">‚ñ∂Ô∏è</span>
            <span>Start the test</span>
          </button>
        </div>
        <div class="small-text">
          Warning: failing this quiz will not remove you from the invite list, but it might affect the amount of teasing you get.
        </div>
      </div>
    </div>

    <!-- Question card -->
    <div id="cardQuestion" class="card">
      <div>
        <div class="card-header-tag" id="questionTag">Question</div>
        <div class="card-title" id="questionTitle">Question goes here</div>
        <div class="card-body" id="questionBody">
          Pick the one that feels most correct. There is only one official answer, but vibes matter.
        </div>
        <div class="options" id="optionsContainer">
          <!-- buttons inserted here by JS -->
        </div>
      </div>
      <div class="small-text" id="questionHint">
        Tip: answer based on what you know about me, not what you think is the polite answer.
      </div>
    </div>

    <!-- Result card -->
    <div id="cardResult" class="card">
      <div>
        <div class="card-header-tag">Debrief</div>
        <div class="card-title" id="resultTitle">You survived the test</div>
        <div class="card-body" id="resultBody">
          Placeholder text for result body.
        </div>
      </div>
      <div>
        <div class="btn-row">
          <button id="btnYes1" class="btn btn-primary">
            <span class="icon">‚úÖ</span>
            <span id="btnYes1Text">Yes, obviously</span>
          </button>
          <button id="btnYes2" class="btn btn-secondary">
            <span class="icon">üî•</span>
            <span id="btnYes2Text">I was born for this</span>
          </button>
        </div>
        <div class="small-text">
          <span class="score-pill">
            <span>Test score</span>
            <span class="value" id="resultScoreText">0 / 0</span>
          </span>
        </div>
      </div>
    </div>

    <!-- Final answer card -->
    <div id="cardFinal" class="card">
      <div>
        <div class="card-header-tag">Squad locked</div>
        <div class="card-title" id="finalTitle">You are in</div>
        <div class="card-body" id="finalBody">
          Screenshot this if you want proof, then text me so we can plan the chaos properly.
        </div>
      </div>
      <div>
        <div class="btn-row">
          <button id="btnDone" class="btn btn-primary">
            <span class="icon">üì≤</span>
            <span>Got it</span>
          </button>
        </div>
        <div class="small-text">
          You can close this tab, but the responsibility is now permanent.
        </div>
      </div>
    </div>

    <footer>
      Designed as a one time invite for the <strong>wedding squad</strong>.
    </footer>
  </div>

  <script>
    // Utility, read URL query parameter with a default
    function getQueryParam(key, defaultValue) {
      const params = new URLSearchParams(window.location.search);
      const value = params.get(key);
      if (!value) return defaultValue;
      return decodeURIComponent(value);
    }

    // Personalization based on name and role
    const guestName = getQueryParam("name", "my friend");
    const guestRoleRaw = getQueryParam("role", "Groomsman");
    const guestRoleLower = guestRoleRaw.toLowerCase();
    const isBestMan = guestRoleLower.includes("best");

    const displayRole = isBestMan ? "Best Man" : "Groomsman";

    // Elements
    const roleLabel = document.getElementById("roleLabel");
    const introTitle = document.getElementById("introTitle");
    const introBody = document.getElementById("introBody");
    const hudQuestion = document.getElementById("hudQuestion");
    const hudScore = document.getElementById("hudScore");
    const questionTag = document.getElementById("questionTag");
    const questionTitle = document.getElementById("questionTitle");
    const questionBody = document.getElementById("questionBody");
    const optionsContainer = document.getElementById("optionsContainer");
    const questionHint = document.getElementById("questionHint");
    const resultTitle = document.getElementById("resultTitle");
    const resultBody = document.getElementById("resultBody");
    const resultScoreText = document.getElementById("resultScoreText");
    const btnYes1Text = document.getElementById("btnYes1Text");
    const btnYes2Text = document.getElementById("btnYes2Text");
    const finalTitle = document.getElementById("finalTitle");
    const finalBody = document.getElementById("finalBody");

    const cardIntro = document.getElementById("cardIntro");
    const cardQuestion = document.getElementById("cardQuestion");
    const cardResult = document.getElementById("cardResult");
    const cardFinal = document.getElementById("cardFinal");

    const btnStart = document.getElementById("btnStart");
    const btnYes1 = document.getElementById("btnYes1");
    const btnYes2 = document.getElementById("btnYes2");
    const btnDone = document.getElementById("btnDone");

    // Quiz content
    // You can customize these per friend if you want
    const questions = [
      {
        title: "How did we actually meet",
        body:
          "There is the official story, and then there is what really happened. Go with what feels true.",
        options: [
          "Through some normal, responsible adult situation",
          "Through a dumb plan that somehow worked",
          "Through a dumb plan that absolutely did not work"
        ],
        correctIndex: 1
      },
      {
        title: "First drink I am probably ordering at the bar",
        body:
          "You have seen this play out enough times to know the answer.",
        options: [
          "Something basic, like beer",
          "Something that looks classy but still hits, like an old fashioned",
          "Whatever the strongest shot is, immediately"
        ],
        correctIndex: 1
      },
      {
        title: "Who panics more when things go wrong",
        body:
          "Wedding day, something breaks, who is more likely to panic first.",
        options: [
          "Me",
          "You",
          "Both, but at least we look calm in photos"
        ],
        correctIndex: 2
      },
      {
        title: "Our default plan when we have no plan",
        body:
          "It is a big life decision. What do we usually end up doing.",
        options: [
          "One drink and a responsible early night",
          "Talk about a responsible early night then ignore that plan",
          "Ask ourselves how we ended up in this situation again"
        ],
        correctIndex: 2
      },
      {
        title: "On the wedding day, how late are you allowed to be",
        body:
          "Think carefully, your answer is legally binding in the group chat.",
        options: [
          "Early, for once in your life",
          "On time, which is already a miracle",
          "Late, but with coffee and a good story"
        ],
        correctIndex: 0
      }
    ];

    let currentIndex = 0;
    let score = 0;

    function showCard(card) {
      [cardIntro, cardQuestion, cardResult, cardFinal].forEach(c => {
        c.classList.remove("active");
      });
      card.classList.add("active");
    }

    function updateHud() {
      const total = questions.length;
      const current = Math.min(currentIndex + 1, total);
      hudQuestion.textContent = `${current} / ${total}`;
      hudScore.textContent = String(score);
    }

    function renderQuestion() {
      const q = questions[currentIndex];
      questionTag.textContent = `Question ${currentIndex + 1}`;
      questionTitle.textContent = q.title;
      questionBody.textContent = q.body;

      // Clear old options
      optionsContainer.innerHTML = "";

      q.options.forEach((opt, idx) => {
        const btn = document.createElement("button");
        btn.className = "option-btn";
        const labelSpan = document.createElement("span");
        labelSpan.className = "label";
        labelSpan.textContent = opt;
        const keySpan = document.createElement("span");
        keySpan.className = "key";
        keySpan.textContent = `${idx + 1}`;
        btn.appendChild(labelSpan);
        btn.appendChild(keySpan);

        btn.addEventListener("click", () => handleAnswer(idx));
        optionsContainer.appendChild(btn);
      });

      // Slightly change hint text on last question
      if (currentIndex === questions.length - 1) {
        questionHint.textContent =
          "Last one. Answer carefully, your Best Man or Groomsman status depends on this. Kind of.";
      } else {
        questionHint.textContent =
          "Answer based on our real history, not the responsible version of us.";
      }

      updateHud();
    }

    function handleAnswer(selectedIndex) {
      const q = questions[currentIndex];
      if (selectedIndex === q.correctIndex) {
        score += 1;
      }

      if (currentIndex + 1 < questions.length) {
        currentIndex += 1;
        renderQuestion();
      } else {
        showResult();
      }
    }

    function showResult() {
      const total = questions.length;
      const s = score;
      let titleText = "";
      let bodyText = "";

      if (s >= total - 1) {
        titleText = "Certified legendary";
        bodyText =
          `${guestName}, you scored ${s} out of ${total}. ` +
          "You clearly know the chaos, the vibes, and the way this is supposed to go. " +
          "You are absolutely " + displayRole + " material.";
      } else if (s >= Math.floor(total / 2)) {
        titleText = "You passed, barely";
        bodyText =
          `${guestName}, you scored ${s} out of ${total}. ` +
          "Some of these answers were a bit suspicious, but honestly that fits our brand. " +
          "I still cannot imagine this without you as my " + displayRole + ".";
      } else {
        titleText = "Very suspicious, but still in";
        bodyText =
          `${guestName}, you scored ${s} out of ${total}. ` +
          "On paper this looks like a fail, but in real life you have been there for all the important moments. " +
          "You are still my choice for " + displayRole + ".";
      }

      resultTitle.textContent = titleText;
      resultBody.textContent = bodyText +
        " There is only one real question left now.";

      resultScoreText.textContent = `${s} / ${total}`;

      const askLine = isBestMan
        ? `Will you be one of my Best Men, ${guestName}`
        : `Will you be my Groomsman, ${guestName}`;

      btnYes1Text.textContent = "Yes, obviously";
      btnYes2Text.textContent = "I was born for this";

      // Adjust result body to end with the ask line
      resultBody.textContent += `\n\n${askLine} ?`;

      showCard(cardResult);
    }

    function showFinal(answerVariant) {
      let title, body;

      if (answerVariant === 1) {
        title = "Locked in";
        body =
          `${guestName}, consider this official. ` +
          `You are my ${displayRole}. ` +
          "Suit up, bring your chaos, and be ready for all the good pressure.";
      } else {
        title = "Exactly the right answer";
        body =
          `${guestName}, I knew you would say that. ` +
          `You are my ${displayRole}. ` +
          "We will do this properly, with good stories and maybe slightly too many drinks.";
      }

      finalTitle.textContent = title;
      finalBody.textContent =
        body + " Screenshot this if you want proof, then text me so we can plan.";
      showCard(cardFinal);
    }

    function initPersonalization() {
      roleLabel.textContent = isBestMan ? "Best Man Invite" : "Groomsman Invite";

      introTitle.textContent = `Welcome, ${guestName}`;
      introBody.innerHTML =
        `This is your <strong>${displayRole} Qualification Test</strong>, ` +
        "also known as the Worst Man stress test.<br /><br />" +
        "You will get a few quick questions about our chaos and my life choices. " +
        "There is no official pass mark, but I will absolutely judge you silently.";
    }

    // Event bindings
    btnStart.addEventListener("click", () => {
      currentIndex = 0;
      score = 0;
      renderQuestion();
      showCard(cardQuestion);
    });

    btnYes1.addEventListener("click", () => showFinal(1));
    btnYes2.addEventListener("click", () => showFinal(2));

    btnDone.addEventListener("click", () => {
      // Nothing fancy here, they can close the tab or go back
      cardFinal.classList.remove("active");
      cardFinal.classList.add("active"); // keep visible but swallow taps
    });

    // Init
    initPersonalization();
    updateHud();
  </script>
</body>
</html>
